<div class="limiter">
  <div class="container-login100">
    <div class="wrap-login100">
      <form
        class="login100-form validate-form"
        (submit)="login(email.value, password.value); $event.preventDefault()"
      >
        <span class="login100-form-title p-b-26">Welcome</span>
        <span class="login100-form-title p-b-48">
          <i class="zmdi zmdi-font"></i>
        </span>

        <div
          class="wrap-input100 validate-input"
          data-validate="Valid email is: a@b.c"
        >
          <input class="input100" type="text" name="email" required #email />
          <span class="focus-input100" data-placeholder="Email"></span>
        </div>

        <div
          class="wrap-input100 validate-input"
          data-validate="Enter password"
        >
          <span class="btn-show-pass">
            <i class="zmdi zmdi-eye"></i>
          </span>
          <input
            class="input100"
            type="password"
            name="password"
            required
            #password
          />
          <span class="focus-input100" data-placeholder="Password"></span>
        </div>

        <div class="container-login100-form-btn">
          <div class="wrap-login100-form-btn">
            <div class="login100-form-bgbtn"></div>
            <button
              class="login100-form-btn"
              type="submit"
              [disabled]="isLoading"
            >
              Login
            </button>
          </div>
        </div>

        <div class="text-center p-t-115">
          <span class="txt1">No tienes una cuenta?</span>
          <a class="txt2" href="#">Registrate</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    "use strict";

    const inputs = document.querySelectorAll(".input100");

    inputs.forEach((input) => {
      input.addEventListener("input", function () {
        if (input.value.trim() !== "") {
          input.classList.add("has-val");
        } else {
          input.classList.remove("has-val");
        }
      });
    });

    // [ Validate ]
    const form = document.querySelector(".validate-form");
    const inputElements = document.querySelectorAll(
      ".validate-input .input100"
    );

    form.addEventListener("submit", function (event) {
      let isValid = true;

      inputElements.forEach((input) => {
        if (!validate(input)) {
          showValidate(input);
          isValid = false;
        }
      });

      if (!isValid) {
        event.preventDefault(); // Previene el envÃ­o si hay errores
      }
    });

    inputElements.forEach((input) => {
      input.addEventListener("focus", function () {
        hideValidate(input);
      });
    });

    function validate(input) {
      if (
        input.getAttribute("type") === "email" ||
        input.getAttribute("name") === "email"
      ) {
        const emailRegex =
          /^([a-zA-Z0-9_\-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([a-zA-Z0-9\-]+\.)+))([a-zA-Z]{1,5}|[0-9]{1,3})(\]?)$/;
        if (input.value.trim().match(emailRegex) === null) {
          return false;
        }
      } else {
        if (input.value.trim() === "") {
          return false;
        }
      }
      return true;
    }

    function showValidate(input) {
      const alertElement = input.parentElement;
      alertElement.classList.add("alert-validate");
    }

    function hideValidate(input) {
      const alertElement = input.parentElement;
      alertElement.classList.remove("alert-validate");
    }

    // [ Show pass ]
    let showPass = false;
    const showPassButtons = document.querySelectorAll(".btn-show-pass");

    showPassButtons.forEach((button) => {
      button.addEventListener("click", function () {
        const input = button.nextElementSibling;
        const icon = button.querySelector("i");

        if (!showPass) {
          input.setAttribute("type", "text");
          icon.classList.remove("zmdi-eye");
          icon.classList.add("zmdi-eye-off");
        } else {
          input.setAttribute("type", "password");
          icon.classList.add("zmdi-eye");
          icon.classList.remove("zmdi-eye-off");
        }
        showPass = !showPass;
      });
    });
  });
</script>
